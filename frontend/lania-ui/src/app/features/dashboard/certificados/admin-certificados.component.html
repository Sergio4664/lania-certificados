<div class="container">
  <header class="header">
    <h1>Gesti√≥n de Certificados</h1>
    <button class="primary-btn" (click)="toggleForm()">
      <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <line x1="12" y1="5" x2="12" y2="19"></line>
        <line x1="5" y1="12" x2="19" y2="12"></line>
      </svg>
      {{ showForm ? 'Cancelar' : 'Crear Certificado' }}
    </button>
  </header>

  <!-- Formulario de Creaci√≥n -->
  <div *ngIf="showForm" class="form-card">
    <h3>Nuevo Certificado</h3>
    <form [formGroup]="certificadoForm" (ngSubmit)="onSubmit()">
      
      <div class="form-group">
        <label for="inscripcion_id">Inscripci√≥n (Participante - Producto) *</label>
        <select id="inscripcion_id" formControlName="inscripcion_id" required>
            <option [ngValue]="null" disabled>Seleccione una inscripci√≥n sin certificado...</option>
            <option *ngFor="let inscripcion of inscripcionesDisponibles" [value]="inscripcion.id">
              {{ inscripcion.participante.nombre_completo }} - {{ inscripcion.producto_educativo.nombre }}
            </option>
        </select>
        <small *ngIf="inscripcionesDisponibles.length === 0">No hay inscripciones disponibles para certificar.</small>
      </div>

      <div class="form-grid">
        <div class="form-group">
            <label for="folio">Folio *</label>
            <input id="folio" formControlName="folio" required placeholder="Ej: LANIA-2025-ABCD">
        </div>
        <div class="form-group">
            <label for="fecha_emision">Fecha de Emisi√≥n *</label>
            <input id="fecha_emision" type="date" formControlName="fecha_emision" required>
        </div>
      </div>

      <div class="form-actions">
        <button type="button" class="secondary-btn" (click)="toggleForm()">Cancelar</button>
        <button type="submit" class="primary-btn" [disabled]="certificadoForm.invalid">Crear</button>
      </div>
    </form>
  </div>

  <!-- Tabla de Certificados -->
  <div class="data-table">
    <table>
      <thead>
        <tr>
          <th>Folio</th>
          <th>Participante</th>
          <th>Producto Educativo</th>
          <th>Fecha de Emisi√≥n</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let cert of certificados">
          <td><span class="folio-tag">{{ cert.folio }}</span></td>
          <td>{{ cert.nombre_participante }}</td>
          <td>{{ cert.nombre_producto }}</td>
          <td>{{ cert.fecha_emision | date:'dd/MM/yyyy' }}</td>
          <td class="actions">
            <a class="icon-btn view" [href]="cert.url_validacion" target="_blank" title="Verificar Certificado">üëÅÔ∏è</a>
            <button class="icon-btn delete" (click)="deleteCertificado(cert)" title="Eliminar">üóëÔ∏è</button>
          </td>
        </tr>
         <tr *ngIf="isLoading">
          <td colspan="5">Cargando certificados...</td>
        </tr>
        <tr *ngIf="!isLoading && certificados.length === 0">
          <td colspan="5">No hay certificados registrados.</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
