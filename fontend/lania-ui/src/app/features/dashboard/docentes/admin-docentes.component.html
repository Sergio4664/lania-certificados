<div class="admin-container">
    <header class="admin-header">
        <h1>Gesti√≥n de Docentes</h1>
        <div class="header-actions">
            <div class="search-container">
                <input type="text" [(ngModel)]="searchTerm" (input)="filterDocentes()" placeholder="Buscar por nombre o especialidad...">
                <svg class="search-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="11" cy="11" r="8"></circle>
                    <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                </svg>
            </div>
            <button class="primary-btn" (click)="toggleForm()">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="12" y1="5" x2="12" y2="19"></line>
                    <line x1="5" y1="12" x2="19" y2="12"></line>
                </svg>
                {{ showForm ? 'Cancelar' : 'Nuevo Docente' }}
            </button>
        </div>
    </header>

    <div *ngIf="showForm" class="form-card">
        <h3>{{ isEditing ? 'Editar Docente' : 'Registrar Docente' }}</h3>
        <form [formGroup]="docenteForm" (ngSubmit)="onSubmit()" class="form-grid">
            
            <div class="form-group">
                <label for="especialidad">Especialidad (T√≠tulo)</label>
                <input id="especialidad" formControlName="especialidad" list="especialidades-sugeridas" placeholder="Ej: DR., ING., M.C.">
                <datalist id="especialidades-sugeridas">
                    <option value="DR."></option>
                    <option value="DRA."></option>
                    <option value="M.C."></option>
                    <option value="ING."></option>
                    <option value="LIC."></option>
                </datalist>
            </div>

            <div class="form-group">
                <label for="nombre_completo">Nombre Completo *</label>
                <input id="nombre_completo" formControlName="nombre_completo" required>
                <div *ngIf="f['nombre_completo'].invalid && (f['nombre_completo'].dirty || f['nombre_completo'].touched)" class="text-danger">
                    <div *ngIf="f['nombre_completo'].errors?.['required']">
                        El nombre completo es obligatorio.
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label for="email_institucional">Email Institucional *</label>
                <input id="email_institucional" type="email" formControlName="email_institucional" required>
                <div *ngIf="f['email_institucional'].invalid && (f['email_institucional'].dirty || f['email_institucional'].touched)" class="text-danger">
                    <div *ngIf="f['email_institucional'].errors?.['required']">
                        El email institucional es obligatorio.
                    </div>
                    <div *ngIf="f['email_institucional'].errors?.['email']">
                        El formato del email no es v√°lido.
                    </div>
                    <div *ngIf="f['email_institucional'].errors?.['forbiddenDomain']">
                        El dominio del correo electr√≥nico no est√° permitido.
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label for="email_personal">Email Personal</label>
                <input id="email_personal" type="email" formControlName="email_personal">
                <div *ngIf="f['email_personal'].invalid && (f['email_personal'].dirty || f['email_personal'].touched)" class="text-danger">
                    <div *ngIf="f['email_personal'].errors?.['email']">
                        El formato del email no es v√°lido.
                    </div>
                    <div *ngIf="f['email_personal'].errors?.['forbiddenDomain']">
                        El dominio del correo electr√≥nico no est√° permitido.
                    </div>
                </div>
            </div>
            
            <div class="form-group">
                <label for="telefono">Tel√©fono</label>
                <input id="telefono" formControlName="telefono">
                <div *ngIf="f['telefono'].invalid && (f['telefono'].dirty || f['telefono'].touched)" class="text-danger">
                    <div *ngIf="f['telefono'].errors?.['minlength']">
                        El n√∫mero de tel√©fono debe tener un m√≠nimo de 10 d√≠gitos.
                    </div>
                    <div *ngIf="f['telefono'].errors?.['maxlength']">
                        El n√∫mero de tel√©fono debe tener un m√°ximo de 14 d√≠gitos.
                    </div>
                </div>
            </div>

            <div class="form-group">
                <label for="whatsapp">WhatsApp</label>
                <input id="whatsapp" formControlName="whatsapp">
                <div *ngIf="f['whatsapp'].invalid && (f['whatsapp'].dirty || f['whatsapp'].touched)" class="text-danger">
                    <div *ngIf="f['whatsapp'].errors?.['minlength']">
                        El n√∫mero de WhatsApp debe tener un m√≠nimo de 10 d√≠gitos.
                    </div>
                    <div *ngIf="f['whatsapp'].errors?.['maxlength']">
                        El n√∫mero de WhatsApp debe tener un m√°ximo de 14 d√≠gitos.
                    </div>
                </div>
            </div>
            
            <div class="form-actions">
                <button type="button" class="secondary-btn" (click)="toggleForm()">Cancelar</button>
                <button type="submit" class="primary-btn" [disabled]="docenteForm.invalid">
                    {{ isEditing ? 'Actualizar' : 'Crear' }} Docente
                </button>
            </div>
        </form>
    </div>

    <div class="data-table">
        <table>
            <thead>
                <tr>
                    <th>Docente</th>
                    <th>Email Institucional</th>
                    <th>Email Personal</th>
                    <th>Tel√©fono</th>
                    <th>WhatsApp</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngIf="isLoading">
                    <td colspan="6" class="no-data">Cargando docentes...</td>
                </tr>
                <tr *ngIf="!isLoading && filteredDocentes.length === 0">
                    <td colspan="6" class="no-data">No se encontraron docentes.</td>
                </tr>
                <tr *ngFor="let docente of filteredDocentes">
                    <td>{{docente.especialidad}} {{docente.nombre_completo}}</td>
                    <td>{{docente.email_institucional}}</td>
                    <td>{{docente.email_personal || 'N/A'}}</td>
                    <td>{{docente.telefono || 'N/A'}}</td>
                    <td>{{docente.whatsapp || 'N/A'}}</td>
                    <td>
                        <div class="actions-cell">
                            <button class="icon-btn edit" (click)="editDocente(docente)" title="Editar Docente">‚úèÔ∏è</button>
                            <button class="icon-btn delete" (click)="deleteDocente(docente)" title="Eliminar Docente">üóëÔ∏è</button>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>